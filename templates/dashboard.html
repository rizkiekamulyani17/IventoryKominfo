{% extends 'base.html' %}

{% block content %}
<div class="dashboard-container" style="padding:30px; font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #e0f7fa, #e1bee7); min-height:100vh;">

    <!-- Sambutan Berjalan -->
    <div class="sambutan-wrapper" style="overflow:hidden; background:rgba(255,255,255,0.85); border-radius:20px; padding:15px; margin-bottom:40px; box-shadow:0 5px 25px rgba(0,0,0,0.15);">
        <p class="sambutan-text" style="white-space:nowrap; font-size:20px; font-weight:700; background: linear-gradient(90deg, #ff6a00, #ee0979, #8e2de2); -webkit-background-clip: text; color: transparent; animation: slideLeft 15s linear infinite;">
            üéâ Selamat datang di Dashboard Inventory Kominfo! Pantau Ruangan & Barang Anda dengan mudah dan cepat üöÄ
        </p>
    </div>

    <h2 style="margin-bottom: 40px; color:#1f2937; font-weight:800;">üìä Dashboard Inventory Kominfo</h2>

    <!-- Cards Section -->
    <div class="cards-wrapper" style="display:flex; flex-wrap:wrap; gap:25px; justify-content:flex-start;">

        <!-- Card Ruangan -->
        <a href="{{ url_for('dashboard_all_ruangan') }}" class="dashboard-card">
            <div class="card-content ruangan-card">
                <div class="icon">üè¢</div>
                <div class="info">
                    <h3>Ruangan</h3>
                    <p>{{ ruangan|length }}</p>
                </div>
            </div>
        </a>

        <!-- Card Barang -->
        <a href="{{ url_for('dashboard_all_barang') }}" class="dashboard-card">
            <div class="card-content barang-card">
                <div class="icon">üì¶</div>
                <div class="info">
                    <h3>Barang</h3>
                    <p>{{ barang|length }}</p>
                </div>
            </div>
        </a>

    </div>

    <!-- Grafik Jumlah Barang per Ruangan -->
    <div class="chart-container" style="margin-top:50px; max-width:950px; background: rgba(255,255,255,0.9); backdrop-filter: blur(15px); border-radius:30px; padding:35px; box-shadow:0 20px 60px rgba(0,0,0,0.2);">
        <h3 style="margin-bottom:30px; color:#1f2937;">üìà Jumlah Barang per Ruangan</h3>
        <canvas id="barangChart"></canvas>
    </div>
</div>

<style>
@keyframes slideLeft {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
}

.dashboard-card {
    text-decoration:none;
    color:inherit;
    flex: 0 1 280px;
}

.card-content {
    display:flex;
    align-items:center;
    border-radius:25px;
    padding:25px;
    transition: transform 0.5s ease, box-shadow 0.5s ease, background 0.5s ease;
    cursor:pointer;
    box-shadow:0 10px 35px rgba(0,0,0,0.15);
    background: rgba(255,255,255,0.25);
    backdrop-filter: blur(15px);
}

.card-content .icon {
    font-size:55px;
    margin-right:20px;
    animation: float 2s ease-in-out infinite;
}

.card-content .info h3 {
    margin:0 0 5px 0;
    font-weight:700;
    font-size:18px;
}

.card-content .info p {
    margin:0;
    font-size:28px;
    font-weight:bold;
}

.ruangan-card { background: linear-gradient(135deg, #6a11cb, #2575fc); color:white; }
.barang-card { background: linear-gradient(135deg, #ff416c, #ff4b2b); color:white; }

.card-content:hover {
    transform: translateY(-12px) scale(1.1);
    box-shadow:0 30px 60px rgba(0,0,0,0.3);
}

@keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-8px); }
}
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx = document.getElementById('barangChart').getContext('2d');

// Gradient garis modern
const gradientStroke = ctx.createLinearGradient(0,0,0,400);
gradientStroke.addColorStop(0, 'rgba(255,99,132,1)');
gradientStroke.addColorStop(0.5, 'rgba(54,162,235,1)');
gradientStroke.addColorStop(1, 'rgba(75,192,192,1)');

const gradientFill = ctx.createLinearGradient(0,0,0,400);
gradientFill.addColorStop(0, 'rgba(255,99,132,0.3)');
gradientFill.addColorStop(0.5, 'rgba(54,162,235,0.2)');
gradientFill.addColorStop(1, 'rgba(75,192,192,0.05)');

new Chart(ctx, {
    type: 'line',
    data: {
        labels: [{% for r in ruangan %}'{{ r.nama_ruangan }}',{% endfor %}],
        datasets: [{
            label: 'Jumlah Barang',
            data: [{% for r in ruangan %}{{ r.total_barang|default(0) }},{% endfor %}],
            fill: true,
            backgroundColor: gradientFill,
            borderColor: gradientStroke,
            borderWidth: 5,
            tension: 0.4,
            pointBackgroundColor: '#fff',
            pointBorderColor: '#4e73df',
            pointRadius: 8,
            pointHoverRadius: 14,
            pointHoverBackgroundColor: '#ffce00',
            pointHoverBorderColor: '#000',
            pointStyle: 'circle'
        }]
    },
    options: {
        responsive: true,
        plugins: {
            legend: { display:true, position:'top', labels:{ font:{ size:14, weight:'bold'} } },
            tooltip: {
                mode: 'index',
                intersect: false,
                backgroundColor: 'rgba(0,0,0,0.8)',
                titleFont: { size:16, weight:'bold' },
                bodyFont: { size:14 },
                padding:12,
                cornerRadius:8
            }
        },
        interaction: { mode: 'nearest', axis:'x', intersect:false },
        scales: {
            y: { 
                beginAtZero:true, 
                ticks: { stepSize:1, font:{size:13} }, 
                grid:{ color:'rgba(0,0,0,0.05)', borderDash:[5,5] } 
            },
            x: { 
                grid:{ color:'rgba(0,0,0,0.05)', borderDash:[5,5] },
                ticks:{ font:{size:13} }
            }
        }
    }
});
</script>
{% endblock %}
